ОПРЕДЕЛИТЬ ПРОЦЕДУРУ отправить_сообщение(базовый_адрес, идентификатор_чата, текст) (
    ЗАДАТЬ адрес = форматировать_строку("{}/sendMessage", базовый_адрес);
    ЗАДАТЬ ключи = массив("chat_id", "text");
    ЗАДАТЬ значения = массив(идентификатор_чата, текст);
    ЗАДАТЬ данные = таблица(ключи, значения);

    НАПЕЧАТАТЬ форматировать_строку("Отправка сообщения в чат: {}", идентификатор_чата);

    ЗАДАТЬ ответ;

    ЦИКЛ попытка ОТ 1 ДО 3 (
        КОНТЕКСТ (
            ответ = запрос_в_интернет("POST", адрес, данные);
            НАПЕЧАТАТЬ форматировать_строку("Сообщение отправлено в чат: {}", идентификатор_чата);
            ВЕРНУТЬ ответ;
        )
        ОБРАБОТЧИК ОшибкаПротоколаПередачиГиперТекста КАК _ (
            НАПЕЧАТАТЬ форматировать_строку("Произошла ошибка, при отправке сообщения в чат: '{}'. Попытка номер: {}", идентификатор_чата, попытка);
            спать(0.5);
        )
    )

    НАПЕЧАТАТЬ форматировать_строку("Не удалось отправить сообщение в чат: {}", идентификатор_чата);
)
