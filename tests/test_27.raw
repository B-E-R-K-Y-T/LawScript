ВКЛЮЧИТЬ стандартная_библиотека.интернет
ВКЛЮЧИТЬ стандартная_библиотека.время
ВКЛЮЧИТЬ стандартная_библиотека.рандом
ВКЛЮЧИТЬ стандартная_библиотека.конкурентность
ВКЛЮЧИТЬ стандартная_библиотека.структуры.*

ОПРЕДЕЛИТЬ ПРОЦЕДУРУ фон_запрос(номер, случ) (
    !ЗАДАТЬ сон = случ:получить_целое_в_диапазоне(0, 0);
    ЗАДАТЬ сон = 1;
    НАПЕЧАТАТЬ "задача номер = " + в_строку(номер) + " запущена! И будет спать: " + в_строку(сон);


        !БЛОКИРОВАТЬ (
    !спать(сон);
!)
    запрос_в_интернет("GET", форматировать_строку("https://httpbin.org/delay/{}", сон), таблица());

    НАПЕЧАТАТЬ "ГОТОВ" + в_строку(номер);

    ВЕРНУТЬ номер;
)

ОПРЕДЕЛИТЬ ПРОЦЕДУРУ вход() (
        ЗАДАТЬ планировщик = ПланировщикЗадач();
        ЗАДАТЬ случ = ГенераторСлучайныхЧисел();
        ЗАДАТЬ с = временная_метка();

        ЦИКЛ счет ОТ 0 ДО 100 (
            !НАПЕЧАТАТЬ "задача номер = " + в_строку(счет) + " запущена!";
            планировщик:добавить(В ФОНЕ фон_запрос(счет, случ));
        )

        НАПЕЧАТАТЬ планировщик:результаты();
        НАПЕЧАТАТЬ временная_метка() - с;
)

ВЫПОЛНИТЬ (
	вход();
)
